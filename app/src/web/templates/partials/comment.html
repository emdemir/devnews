{# -*- mode: web -*- #}
{# -*- engine: nunjucks -*- #}

<div class="comment" id="c_{{ comment.short_url }}">
    <form method="POST" action="/c/{{ comment.short_url }}/vote">
        {% include "partials/csrf.html" %}
        <button type="submit" class="vote-button {% if comment.user_voted %}voted{% endif %}">
            {% if comment.user_voted %}Unvote{% else %}Vote{% endif %}
        </button>
    </form>
    <div class="comment-info">
        <span class="comment-score">
            {{ comment.score }} point{% if comment.score !== 1 %}s{% endif %}
        </span>
        by
        <a href="/u/{{ comment.username }}">{{ comment.username }}</a>
        <!-- TODO: date difference -->
        TODO hours ago

        {# comment.user_read being undefined won't match. #}
        {% if comment.user_read === false %}
            <span class="comment-unread">(unread)</span>
        {% endif %}
    </div>
    <div class="comment-contents">
        {{ comment.comment_html | safe }}
    </div>

    <div class="comment-children">
        {% set parent = comment %}
        {% for comment in parent.children %}
            {% include "partials/comment.html" %}
        {% endfor %}
    </div>
</div>
