{# -*- mode: web -*- #}
{# -*- engine: nunjucks -*- #}

{% set title = "Submit a Story" %}
{% extends "layout.html" %}

{% block content %}
<div class="create-story-page">
    <div class="box">
        <h3 class="box-title">Submit a Story</h3>

        {% include "partials/errors.html" %}

        <form method="POST">
            {% include "partials/csrf.html" %}
            <dl class="form-fields full-width create-story-fields">
                <dt><label for="title">Title</label></dt>
                <dd><input type="text" name="title" required
                           maxlength="100" value="{{ formData.title }}" />
                    <p><small>Please do not editorialize titles.</small></p></dd>

                <dt><label for="url">Story URL</label></dt>
                <dd><input type="url" name="url"
                           maxlength="200" value="{{ formData.url }}" /></dd>

                <dt style="grid-column: 1 / 3; text-align: center">...or...</dt>

                <dt><label for="text">Story text</label></dt>
                <dd><textarea name="text">{{ formData.text }}</textarea></dd>

                <dt><label for="tags">Tags</label>
                    <p><small>(at least one and at most three. Select any that apply)</small></p>
                </dt>
                <dd><div class="story-tags">
                        {% for tag in tags %}
                            <p><label>
                                <input type="checkbox" name="tags" value="{{ tag.name }}"
                                    {% if formData.tags and (
                                        formData.tags == tag.id or (
                                            formData.tags.length and
                                            formData.tags.includes(tag.id.toString())
                                        )
                                    ) %}checked{% endif %} />
                                {{ tag.name }} &mdash; {{ tag.description }}
                            </label></p>
                        {% endfor %}
                    </div></dd>

                <dt><label for="is_authored">I am the author of this story</label></dt>
                <dd><input type="checkbox" name="is_authored"
                           {% if formData.is_authored %}checked{% endif %} /></dd>
            </dl>

            <br />
            <p class="text-center">
                Before submitting, please review our
                <a href="/auth/rules/">site rules</a>.
            </p>

            <button type="submit" class="button submit-button">Submit Story</button>
        </form>
    </div>
</div>
{% endblock %}
